module "security_enforced" {
  source                                 = "../fully-configurable"
  ibmcloud_api_key                       = var.ibmcloud_api_key
  ibmcloud_kms_api_key                   = var.ibmcloud_kms_api_key
  provider_visibility                    = "private"
  prefix                                 = var.prefix
  region                                 = var.region
  existing_resource_group_name           = var.existing_resource_group_name
  cloud_logs_instance_name               = var.cloud_logs_instance_name
  cloud_logs_resource_tags               = var.cloud_logs_resource_tags
  cloud_logs_access_tags                 = var.cloud_logs_access_tags
  cloud_logs_retention_period            = var.cloud_logs_retention_period
  existing_cos_instance_crn              = var.existing_cos_instance_crn
  logs_cos_bucket_name                   = var.logs_cos_bucket_name
  metrics_cos_bucket_name                = var.metrics_cos_bucket_name
  cloud_logs_cos_buckets_class           = var.cloud_logs_cos_buckets_class
  management_endpoint_type_for_bucket    = "private"
  skip_cos_kms_iam_auth_policy           = var.skip_cos_kms_iam_auth_policy
  kms_encryption_enabled_bucket          = true
  existing_kms_instance_crn              = var.existing_kms_instance_crn
  existing_kms_key_crn                   = var.existing_kms_key_crn
  kms_endpoint_type                      = "private"
  cloud_log_storage_key_ring             = var.cloud_log_storage_key_ring
  cloud_log_storage_key                  = var.cloud_log_storage_key
  existing_event_notifications_instances = var.existing_event_notifications_instances
  skip_logs_routing_auth_policy          = var.skip_logs_routing_auth_policy
  logs_routing_tenant_regions            = var.logs_routing_tenant_regions
  logs_policies                          = var.logs_policies
}
